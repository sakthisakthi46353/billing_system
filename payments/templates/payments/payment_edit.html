{% extends "base.html" %}
{% block title %}Edit Payment #{{ payment.id }}{% endblock %}

{% block content %}

<div class="container mt-4">

  <div class="card shadow-sm p-4">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3>Edit Payment #{{ payment.id }}</h3>
      <a href="{% url 'payments:payment_list' %}" class="btn btn-secondary btn-sm">
        ‚Üê Back to Payments
      </a>
    </div>

    <hr>

    <form method="post">
      {% csrf_token %}

      <!-- Invoice -->
      <div class="mb-3">
        <label class="form-label">Invoice</label>
        <select name="invoice" class="form-select" required>
          {% for inv in invoices %}
            <option value="{{ inv.id }}"
              {% if inv.id == payment.invoice.id %}selected{% endif %}>
              Invoice #{{ inv.id }} ‚Äî {{ inv.customer.name }}
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- Date -->
      <div class="mb-3">
        <label class="form-label">Payment Date</label>
        <input
          type="date"
          name="date"
          class="form-control"
          value="{{ payment.date|date:'Y-m-d' }}"
          required
        >
      </div>

      <!-- Amount -->
      <div class="mb-3">
        <label class="form-label">Amount (‚Çπ)</label>
        <input
          type="number"
          step="0.01"
          name="amount"
          class="form-control"
          value="{{ payment.amount }}"
          required
        >
        <small class="text-muted">
          Changing amount will automatically update invoice status.
        </small>
      </div>

      <!-- Method -->
      <div class="mb-3">
        <label class="form-label">Payment Method</label>
        <select name="method" class="form-select">
          <option value="CASH" {% if payment.method == "CASH" %}selected{% endif %}>
            Cash
          </option>
          <option value="UPI" {% if payment.method == "UPI" %}selected{% endif %}>
            UPI
          </option>
          <option value="BANK" {% if payment.method == "BANK" %}selected{% endif %}>
            Bank Transfer
          </option>
        </select>
      </div>

      <!-- Buttons -->
      <div class="d-flex gap-2 mt-4">
        <button type="submit" class="btn btn-primary">
          üíæ Update Payment
        </button>
        <a href="{% url 'payments:payment_list' %}" class="btn btn-secondary">
          Cancel
        </a>
      </div>

    </form>

  </div>

</div>

{% endblock %}
